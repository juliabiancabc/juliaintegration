<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Events Platform{% endblock %}</title>
    {% block head %}{% endblock %}
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .navbar { background: rgba(255, 255, 255, 0.95); padding: 15px 30px; border-radius: 10px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        .nav-links { display: flex; gap: 20px; list-style: none; }
        .nav-links a { text-decoration: none; color: #333; padding: 8px 16px; border-radius: 5px; transition: all 0.3s; }
        .nav-links a:hover { background: #f0f0f0; }
        .nav-links a.active { background: #667eea; color: white; }
        .user-info { display: flex; align-items: center; gap: 15px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); }
        .flash-messages { margin-bottom: 20px; }
        .alert { padding: 12px 20px; border-radius: 8px; margin-bottom: 10px; }
        .alert-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .alert-danger { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .alert-warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .alert-info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .btn { padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; text-decoration: none; display: inline-block; transition: all 0.3s; font-size: 14px; }
        .btn-primary { background: #667eea; color: white; }
        .btn-primary:hover { background: #5568d3; }
        .btn-success { background: #28a745; color: white; }
        .btn-success:hover { background: #218838; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-danger:hover { background: #c82333; }
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #5a6268; }
        h1, h2, h3 { color: #333; margin-bottom: 20px; }
    </style>
</head>
<body>
    {% if session.user_id %}
    <nav class="navbar">
        <div class="nav-links">
            <a href="#">Home</a>
            <a href="#">Stories</a>
            <a href="{{ url_for('admin_dashboard') }}" class="active">Events</a>
            <a href="#">Profile</a>
        </div>
        <div class="user-info">
            <span>Welcome, {{ session.username }}!</span>
            <a href="{{ url_for('logout') }}" class="btn btn-secondary">Logout</a>
        </div>
    </nav>
    {% endif %}
    <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flash-messages">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}
        {% block content %}{% endblock %}
    </div>
<div id="registrationModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999;">
    <div style="position:relative; margin:10% auto; width:400px; background:white; padding:30px; border-radius:10px;">
        <h3 style="margin-bottom:20px;">Register for Event</h3>
        <form id="registrationForm" method="POST">
            <label style="display:block; margin-bottom:10px; font-weight:600;">Special access needs, food allergies:</label>
            <textarea name="special_requests" style="width:100%; height:100px; padding:10px; border:1px solid #ddd; border-radius:5px;" placeholder="Enter any special requirements..."></textarea>
            <div style="display:flex; gap:10px; margin-top:20px;">
                <button type="submit" class="btn btn-primary" style="flex:1;">Confirm Registration</button>
                <button type="button" onclick="closeRegistrationModal()" class="btn btn-secondary">Cancel</button>
            </div>
        </form>
    </div>
</div>

<div id="unregisterModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999;">
    <div style="position:relative; margin:10% auto; width:400px; background:white; padding:30px; border-radius:10px;">
        <h3 style="margin-bottom:20px;">Unregister from Event</h3>
        <p style="margin-bottom:20px;">Are you sure you want to unregister from this event?</p>
        <div style="display:flex; gap:10px;">
            <a id="confirmUnregister" href="#" class="btn btn-danger" style="flex:1; text-align:center;">Yes, Unregister</a>
            <button type="button" onclick="closeUnregisterModal()" class="btn btn-secondary">Cancel</button>
        </div>
    </div>
</div>

<script>
function showRegistrationModal(eventId) {
    document.getElementById('registrationModal').style.display = 'block';
    document.getElementById('registrationForm').action = '/register/' + eventId;
}

function closeRegistrationModal() {
    document.getElementById('registrationModal').style.display = 'none';
}

function showUnregisterModal(eventId) {
    document.getElementById('unregisterModal').style.display = 'block';
    document.getElementById('confirmUnregister').href = '/unregister/' + eventId;
}

function closeUnregisterModal() {
    document.getElementById('unregisterModal').style.display = 'none';
}
</script>
Chatbot Widget
<div id="chatbot-container" style="position: fixed; bottom: 20px; right: 20px; z-index: 10000;">
    <!-- Chat Toggle Button -->
    <button id="chatbot-toggle" style="width: 60px; height: 60px; border-radius: 50%; background: #5B4FE9; color: white; border: none; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2); font-size: 24px;">
        ðŸ’¬
    </button>
    
    <!-- Chat Window -->
    <div id="chatbot-window" style="display: none; position: absolute; bottom: 80px; right: 0; width: 350px; height: 500px; background: white; border-radius: 10px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); flex-direction: column;">
        <!-- Header -->
        <div style="background: #5B4FE9; color: white; padding: 15px; border-radius: 10px 10px 0 0; display: flex; justify-content: space-between; align-items: center;">
            <span style="font-weight: 600;">Event Assistant</span>
            <button id="chatbot-close" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">Ã—</button>
        </div>
        
        <!-- Messages Area -->
        <div id="chatbot-messages" style="flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; background: #f5f5f5;">
            <div class="bot-message" style="background: white; padding: 10px; border-radius: 8px; max-width: 80%; box-shadow: 0 1px 2px rgba(0,0,0,0.1);">
                Hello! I'm your event assistant. How can I help you today?
            </div>
        </div>
        
        <!-- Input Area -->
        <div style="padding: 15px; border-top: 1px solid #ddd; background: white; border-radius: 0 0 10px 10px;">
            <div style="display: flex; gap: 10px;">
                <input type="text" id="chatbot-input" placeholder="Type a message..." style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                <button id="chatbot-send" style="background: #5B4FE9; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 600;">Send</button>
            </div>
        </div>
    </div>
</div>

<!-- <script>
// Chatbot functionality
const chatbotToggle = document.getElementById('chatbot-toggle');
const chatbotWindow = document.getElementById('chatbot-window');
const chatbotClose = document.getElementById('chatbot-close');
const chatbotInput = document.getElementById('chatbot-input');
const chatbotSend = document.getElementById('chatbot-send');
const chatbotMessages = document.getElementById('chatbot-messages');

// Toggle chat window
chatbotToggle.addEventListener('click', () => {
    if (chatbotWindow.style.display === 'none') {
        chatbotWindow.style.display = 'flex';
    } else {
        chatbotWindow.style.display = 'none';
    }
});

chatbotClose.addEventListener('click', () => {
    chatbotWindow.style.display = 'none';
});

// Send message function
async function sendMessage() {
    const message = chatbotInput.value.trim();
    if (!message) return;
    
    // Add user message to chat
    const userMsgDiv = document.createElement('div');
    userMsgDiv.className = 'user-message';
    userMsgDiv.style.cssText = 'background: #5B4FE9; color: white; padding: 10px; border-radius: 8px; max-width: 80%; align-self: flex-end; margin-left: auto; box-shadow: 0 1px 2px rgba(0,0,0,0.1);';
    userMsgDiv.textContent = message;
    chatbotMessages.appendChild(userMsgDiv);
    
    chatbotInput.value = '';
    chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    
    // Show typing indicator
    const typingDiv = document.createElement('div');
    typingDiv.id = 'typing-indicator';
    typingDiv.className = 'bot-message';
    typingDiv.style.cssText = 'background: white; padding: 10px; border-radius: 8px; max-width: 80%; box-shadow: 0 1px 2px rgba(0,0,0,0.1);';
    typingDiv.innerHTML = '<span style="color: #666;">Typing...</span>';
    chatbotMessages.appendChild(typingDiv);
    chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    
    try {
        // Send to backend
        const response = await fetch('/api/chat', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ message: message })
        });
        
        const data = await response.json();
        
        // Remove typing indicator
        typingDiv.remove();
        
        // Check if there's an error
        if (data.error) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'bot-message';
            errorDiv.style.cssText = 'background: #ffebee; color: #c62828; padding: 10px; border-radius: 8px; max-width: 80%; box-shadow: 0 1px 2px rgba(0,0,0,0.1);';
            errorDiv.textContent = 'Error: ' + data.error;
            chatbotMessages.appendChild(errorDiv);
        } else {
            // Add bot response
            const botMsgDiv = document.createElement('div');
            botMsgDiv.className = 'bot-message';
            botMsgDiv.style.cssText = 'background: white; padding: 10px; border-radius: 8px; max-width: 80%; box-shadow: 0 1px 2px rgba(0,0,0,0.1); line-height: 1.5;';
            botMsgDiv.textContent = data.response;
            chatbotMessages.appendChild(botMsgDiv);
        }
        
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    } catch (error) {
        // Remove typing indicator
        typingDiv.remove();
        
        const errorDiv = document.createElement('div');
        errorDiv.className = 'bot-message';
        errorDiv.style.cssText = 'background: #ffebee; color: #c62828; padding: 10px; border-radius: 8px; max-width: 80%; box-shadow: 0 1px 2px rgba(0,0,0,0.1);';
        errorDiv.textContent = 'Error: Could not connect to chatbot';
        chatbotMessages.appendChild(errorDiv);
        
        console.error('Chatbot error:', error);
    }
}

chatbotSend.addEventListener('click', sendMessage);
chatbotInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') sendMessage();
});
</script> -->

</body>
</html>
